{% macro summary(elapsed, uptime_relative, compliant_uptime_relative, uptime_absolute, compliant_uptime_absolute, weighted_average_bid, weighted_average_ask, spread_absolute, spread_relative, instrument, accounts, target_liquidity, target_spread, from_, to, max) %}
    <div class="card" id="summary">
        <div class="card-header py-3">
            <h2 class="h6 fw-bold mb-1">Summary</h2>
        </div>

        <div class="card-body">
            <p class="card-subtitle mb-3">
                Summary statistics for the selected market makers. Uptime is calculated by summing up the time deltas of the order book ticks during which the market maker(s) quoted a spread: see <a href="https://github.com/waterquarks/mangolorians/blob/06b4418ec1f8c83a64cc72722f8cdd38be56c71d/scrapers/reconstruct_l3_order_book.py#L121-L251" class="text-warning text-decoration-none" target="_blank">here</a> for the underlying code.
                You can measure these stats against a target liquidity or spread by entering one below.
            </p>

            <form hx-get="/analytics/benchmark/" method="get" hx-target="#summary" hx-trigger="submit" hx-swap="outerHTML">
                <div class="justify-content-center align-items-center py-4" id="loader">
                    <div class="spinner-border text-secondary" role="status">
                    </div>
                </div>

                <div class="content">
                     <div class="d-lg-flex d-sm-block align-items-end my-3 flex-wrap">
                         <input type="hidden" name="instrument" value="{{ instrument }}">
                         <input type="hidden" name="accounts" value="{{ accounts }}">

                         <div class="flex-grow-1">
                             <label for="from">From</label>
                             <input class="form-control" type="datetime-local" name="from" id="from" min="2022-04-12T00:00" max="{{ max }}" value="{{ from_ }}">
                         </div>

                         <div class="my-2 my-lg-0 mx-lg-2 flex-grow-1">
                             <label for="to">To</label>
                             <input class="form-control" type="datetime-local" name="to" id="to" min="2022-04-12T00:00" max="{{ max }}" value="{{ to }}">
                         </div>

                         <div class="my-2 my-lg-0 mx-lg-2 flex-grow-1">
                             <label for="target_liquidity" class="form-label fw-bold fs-6">Target liquidity</label>
                             <input type="number" class="form-control" name="target_liquidity" id="target_liquidity"
                                    value="{{ target_liquidity or 1000 }}">
                         </div>

                         <div class="flex-grow-1">
                             <label for="target_spread" class="form-label fw-bold fs-6">Target spread (%)</label>
                             <input type="number" class="form-control" name="target_spread" id="target_spread"
                                    step="0.01" value="{{ target_spread or 0.15 }}">
                         </div>

                         <div class="ms-lg-2">
                            <button type="submit" class="mt-3 btn btn-primary w-100">Submit</button>
                         </div>
                    </div>

                    <div class="pb-3" style="border-bottom: 1px solid rgb(55, 50, 77)">
                        <div style="color: rgb(193, 190, 211); font-size: 14px;">Average bid</div>
                        <div style="color: rgb(229, 231, 235); font-size: 24px; font-weight: 700;">${{ "{:0.2f}".format(weighted_average_bid or 0 ) }}</div>
                    </div>

                    <div class="py-3" style="border-bottom: 1px solid rgb(55, 50, 77)">
                        <div style="color: rgb(193, 190, 211); font-size: 14px;">Average ask</div>
                        <div style="color: rgb(229, 231, 235); font-size: 24px; font-weight: 700;">${{ "{:0.2f}".format(weighted_average_ask or 0) }}</div>
                    </div>

                    <div class="py-3" style="border-bottom: 1px solid rgb(55, 50, 77)">
                        <div style="color: rgb(193, 190, 211); font-size: 14px;">Average spread</div>
                        <div style="color: rgb(229, 231, 235); font-size: 24px; font-weight: 700;">${{ "{:0.2f}".format(spread_absolute or 0) }} ({{ "{:0.2f}".format(spread_relative or 0) }}%)</div>
                    </div>

                    <div class="py-3" style="border-bottom: 1px solid rgb(55, 50, 77)">
                        <div style="color: rgb(193, 190, 211); font-size: 14px;">Uptime</div>
                        <div style="color: rgb(229, 231, 235); font-size: 24px; font-weight: 700;">{{ "{:0.0f}".format((uptime_relative or 0) * 100) }}% ({{ "{:0.2f}".format((uptime_absolute or 0) * 24 ) }} hours out of {{ "{:0.2f}".format((elapsed or 0) * 24) }} elapsed)</div>
                    </div>

                    <div class="pt-3">
                        <div style="color: rgb(193, 190, 211); font-size: 14px;">Uptime for target spread ({{ target_spread }}%)</div>
                        <div style="color: rgb(229, 231, 235); font-size: 24px; font-weight: 700;">{{ "{:0.0f}".format((compliant_uptime_relative or 0) * 100) }}% ({{ "{:0.2f}".format((compliant_uptime_absolute or 0) * 24 ) }} hours out of {{ "{:0.2f}".format((elapsed or 0) * 24) }} elapsed)</div>
                    </div>
                </div>
            </form>
        </div>
    </div>
{% endmacro %}